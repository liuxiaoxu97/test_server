# 微信
### 微信公众号
#### 关注公众号登录流程
必须生成和扫描带参数的二维码，流程如下：
1. 前端请求后端生成二维码 
- 前端请求：
   - 前端向后端发送请求，请求生成一个带参数的二维码。
   - 请求参数可以包括用户的一些基本信息（如用户类型等）。
- 后端处理：
   - 后端接收到请求后，生成一个唯一的 uuid，作为二维码的参数（即场景码 scene）。
   - 后端调用微信提供的接口，生成二维码的 ticket。
   - 后端将 uuid 和 ticket 返回给前端。
2. 前端生成二维码
- 前端处理：
   - 前端拿到 ticket 和 scene（uuid）。
   - 使用 ticket 向微信服务器请求获取二维码图片。
   - 前端展示二维码图片给用户。
3. 用户扫码
- 用户操作：
   - 用户使用微信扫描二维码。
- 微信服务器通知后端：
   - 用户扫码成功后，微信服务器会将扫码事件推送到后端接口。
   - 后端接收到事件后，判断是否是带参数的扫码事件。
   - 如果是带参数的扫码事件，提取事件中的 scene（即 uuid）和用户的 openid。
   - 后端将 scene（uuid）作为键，openid 作为值，存入 Redis 中。
4. 前端轮询后端接口
- 前端轮询：
   - 前端展示完二维码后，开始轮询后端接口。
   - 每次轮询携带 scene（uuid）作为参数。
- 后端处理：
   - 后端通过 scene（uuid）去 Redis 中查询对应的 openid。
   - 如果 Redis 中没有找到对应的 key，说明用户还没有扫码，返回未扫码的状态。
   - 如果 Redis 中找到了对应的 openid，后端进一步处理：
   - 先将用户信息保存在库中，之后使用open ID进行授权登录，登录后将token 等信息返回给前端
- 前端处理：
   - 前端根据后端返回的结果进行处理：
   - 如果返回未扫码状态，继续轮询。
   - 如果返回登录状态，提示登录成功并跳转到主页面。

